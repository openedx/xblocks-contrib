{% load i18n capa_filters %}
<div class="annotation-input">
    <div class="script_placeholder"
         data-src="{{ STATIC_URL }}js/capa/annotationinput.js"></div>
    <div class="annotation-header">
        {{ title|safe }}
        {% if return_to_annotation %}
            <a class="annotation-return" href="javascript:void(0)">Return to Annotation</a>
            <br />
        {% endif %}
    </div>
    <div class="annotation-body">
        <div class="block block-highlight">{{ text|safe }}</div>
        <div class="block block-comment">{{ comment|safe }}</div>
        <div class="block">{{ comment_prompt|safe }}</div>
        <textarea class="comment"
                  id="input_{{ id }}_comment"
                  name="input_{{ id }}_comment"
                  aria-describedby="answer_{{ id }}">{{ comment_value }}</textarea>
        <div class="block" id="label_{{ id }}">{{ tag_prompt|safe }}</div>
        <ul class="tags">
            {% for option in options %}
                <li>
                    {% if has_options_value %}
                        {% if option.choice == status.classname and status == status.classname %}
                            <span class="tag-status {{ status.classname }}"
                                  aria-describedby="input_{{ id }}_comment">
                                <span class="status {% if hide_correctness %}{% else %}{{ status.classname }}{% endif %}"
                                      data-tooltip="{% if hide_correctness %}{% else %}{{ status.display_tooltip }}{% endif %}">
                                    {% if not hide_correctness %}
                                        <span class="sr">{{ status.display_name }}</span>
                                        <span class="status-icon" aria-hidden="true"></span>
                                    {% endif %}
                                </span>
                            </span>
                        {% endif %}
                    {% endif %}
                    <span class="tag {% if option.id in options_value %}selected{% endif %} "
                          data-id="{{ option.id }}">{{ option.description|safe }}</span>
                </li>
            {% endfor %}
        </ul>
        {% if debug %}
            <div class="debug-value">
                Rendered with value:
                <br />
                <pre>{{ value }}</pre>
                Current input value:
                <br />
                <input type="text"
                       class="value"
                       name="input_{{ id }}"
                       id="input_{{ id }}"
                       value="{{ value }}" />
            </div>
        {% else %}
            <input type="hidden"
                   class="value"
                   name="input_{{ id }}"
                   id="input_{{ id }}"
                   value="{{ value }}" />
        {% endif %}
        {% if id == '' %}
            <span class="status {% if hide_correctness %}{% else %}{{ status.classname }}{% endif %}"
                  data-tooltip="{% if hide_correctness %}{% else %}{{ status.display_tooltip }}{% endif %}">
            {% else %}
                <span class="status {% if hide_correctness %}{% else %}{{ status.classname }}{% endif %}"
                      id="status_{{ id }}"
                      data-tooltip="{% if hide_correctness %}{% else %}{{ status.display_tooltip }}{% endif %}">
                {% endif %}
                {% if not hide_correctness %}
                    <span class="sr">{{ status.display_name }}</span>
                    <span class="status-icon" aria-hidden="true"></span>
                {% endif %}
            </span>
            <p id="answer_{{ id }}" class="answer answer-annotation"></p>
        </div>
    </div>
    {% if msg %}<span class="message" aria-describedby="label_{{ id }}" tabindex="-1">{{ msg|safe }}</span>{% endif %}
